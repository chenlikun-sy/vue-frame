<template><div class=echart-main-div ref=chartPie1></div></template><script lang='es6'>"use strict";define(["vju","echart"],function(t,e){return t.component("comp-echart-pie",{template:template,props:{dataSource:{type:Array,default:function(){return[]}},fontColor:{type:String,default:"#333"},sideSize:{type:Array,default:function(){return["50%","70%"]}},label:{type:Object,default:function(){return{}}},labelFormatterFun:{type:Function,default:function(t){return t.name}},tipFormatterFun:{type:Function,default:function(t){return t.name+":"+t.value+"("+t.percent+"%)"}},showLegend:{type:Boolean,defalut:!1},legendTextColor:{type:String,default:"#fff"}},data:function(){return{myChart:null,baseoption:null,legendOrient:"vertical",gridTop:60,gridLeft:"10%",gridRight:60,gridBottom:"10%",legendData:[]}},mounted:function(){this.myChart=e.init(this.$refs.chartPie1),this.initOption(),this.drawEcharts()},destroyed:function(){this.myChart&&(this.myChart=null),this.legendData&&(this.legendData=[],this.legendData=null),this.baseoption&&(this.baseoption=null)},watch:{dataSource:function(){this.drawEcharts()}},methods:{initOption:function(){var t=this;this.baseoption={tooltip:{trigger:"item",formatter:t.tipFormatterFun,align:"left",position:function(t){return[t[0]-100,t[1]-10]}},legend:{show:t.showLegend,orient:t.legendOrient,x:t.legendX,textStyle:{color:t.legendTextColor}},series:[{type:"pie",clockWise:!0,selectedMode:"single",radius:t.sideSize,data:[]}]}},drawEcharts:function(){var t=this.initialOption();if(this.dataSource){var e=this.dataSource;if(this.legendData=[],e&&0<e.length)for(var i=0;i<e.length;i++){var n={};n.name=e[i].name,void 0===e[i].value?n.value=0:n.value=e[i].value,e[i].color&&(n.itemStyle={normal:{color:e[i].color}}),""!==this.label&&(t.series[0].label=this.label),n.userObject=e[i],t.series[0].data.push(n),this.legendData.push(n.name)}t.legend.data=this.legendData}this.myChart.setOption(t)},initialOption:function(){var t=$.extend(!0,{},this.baseoption);return t.grid={top:this.gridTop,left:this.gridLeft,right:this.gridRight,bottom:this.gridBottom,containLabel:!0},t},showMarkLine:function(){this.markLineFlag=!0,this.drawEcharts()},hideMarkLine:function(){this.markLineFlag=!1,this.drawEcharts()},chartResize:function(){this.myChart&&this.myChart.resize()}}})});</script><style scoped>.echart-main-div{height:100%;min-height:100px;min-width:100px}</style>